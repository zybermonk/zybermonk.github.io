<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Topic modeling | Mohan Ramesh</title> <meta name="author" content="Mohan Ramesh"/> <meta name="description" content="An unsupervised clustering example project"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://zybermonk.github.io/projects/topic_modeling/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Mohan </span>Ramesh</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blogs</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">resume</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Topic modeling</h1> <p class="post-description">An unsupervised clustering example project</p> </header> <article> <ul> <li>Author: Mohan Ramesh</li> </ul> <h1 id="topic-modeling">Topic Modeling</h1> <p>From the 737 documents pre-classified into 5 topical groups, this notebook tries to create further interesting sub-groups within those classes (Intra-class clustering). Manually examining the documents hinted towards having the headline of the news articles as the first line of each of the documents, and the rest being the news. The approach followed here is a simple baseline skeleton model with scope to intervene in various stages of the development process.</p> <ul> <li>A higher level architecture of the approach followed can be visualized like this:</li> </ul> <div> <figure> <picture> <img src="/assets/img/projects/topic/ss.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <blockquote> <p><strong>Getting the data ready</strong></p> </blockquote> <p>The news is split into its respective title and the content. Since there is only 1 feature, it can be considered as “ feature engineering “ step in this case and also for other reasons like;</p> <ul> <li>most of the words in the title are already present in the content,</li> <li>reducing redundancy,</li> <li>entity extraction.</li> </ul> <p><em><strong>ps</strong>: wanted to extract entities from the title (nouns), but made the process complicated:(</em></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1">#not the best way to load the data, but hardcoded to specific need
</span>
<span class="n">df</span><span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'loan'</span><span class="p">])</span>
<span class="k">for</span> <span class="n">filepath</span> <span class="ow">in</span> <span class="n">glob</span><span class="p">.</span><span class="nf">glob</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">path</span><span class="p">(</span><span class="s">'train.txt'</span><span class="p">)):</span>
    <span class="n">my_file</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">my_text</span> <span class="o">=</span> <span class="n">my_file</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
    <span class="n">my_file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
    <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="nf">len</span><span class="p">(</span><span class="n">df</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">my_text</span><span class="p">]</span>

<span class="n">df2</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s">'news'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">df1</span><span class="p">[</span><span class="s">'news'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s">'news'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">concat</span><span class="p">([</span><span class="n">df2</span><span class="p">,</span> <span class="n">df1</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>title</th> <th>news</th> </tr> </thead> <tbody> </tbody> </table> </div> <p>Basic pre-processing is performed by using the NLTK, re libraries.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">nltk</span>
<span class="kn">from</span> <span class="n">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">from</span> <span class="n">nltk.stem</span> <span class="kn">import</span> <span class="n">WordNetLemmatizer</span>

<span class="c1">#Basic preprocessing
</span><span class="n">l</span><span class="o">=</span><span class="nc">WordNetLemmatizer</span><span class="p">()</span>
<span class="n">core</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">df</span><span class="p">)):</span>
    
    <span class="n">r</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="s">'[^a-zA-Z0-9()]'</span><span class="p">,</span> <span class="s">' '</span><span class="p">,</span><span class="n">df</span><span class="p">[</span><span class="s">'news'</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">.</span><span class="nf">lower</span><span class="p">()</span>
    <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">.</span><span class="nf">split</span><span class="p">()</span>
    <span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="n">l</span><span class="p">.</span><span class="nf">lemmatize</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">r</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">.</span><span class="nf">words</span><span class="p">(</span><span class="s">'english'</span><span class="p">)]</span>  <span class="c1">#stemming will make lose the meaning of created subtopics in this case
</span>    <span class="n">r</span><span class="o">=</span><span class="s">' '</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">core</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>



</code></pre></div></div> <blockquote> <p><strong>Vectorization</strong></p> </blockquote> <p>TF-IDF is chosen over a basic bag of words in hopes of getting more semantic value out of the corpus. However, the bag of words will form poor clusters anyway in this particular case as the amount of repeated words are significantly higher since the topics are already inside a class! <br> <strong><em>note</em></strong>: There are advanced vectorization techniques to extract features and inturn creating more meaningful clusters.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="n">vr</span><span class="o">=</span><span class="nc">TfidfVectorizer</span><span class="p">(</span><span class="n">max_features</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span><span class="n">max_df</span><span class="o">=</span><span class="mf">0.70</span><span class="p">,</span><span class="n">min_df</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">stop_words</span> <span class="o">=</span> <span class="s">"english"</span><span class="p">)</span>
<span class="n">vec</span><span class="o">=</span><span class="n">vr</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">core</span><span class="p">)</span>
</code></pre></div></div> <p>At most there were found to be around 750+ unique features in the athletics class, and top 350 have been chosen be converted into vectors, to reduce the dimensionality of the model.<br> Other model parameters are selected vaguely based on intuition and a little on trial and error basis.</p> <blockquote> <p><strong>Finding optimal K-value</strong></p> </blockquote> <p>Since, the amount of subtopics to generate is purely subjective to each class, running the alogrithm to create n number of groups starting from 1 is a good approach. This method is called the ‘elbow method’ as the ideal # of groups will be selected at the point where the graph of this K-means tend to abruptly stabalize, which looks like an elbow!</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="n">prom</span><span class="o">=</span><span class="p">[]</span>
<span class="n">k</span><span class="o">=</span><span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
    <span class="n">model</span><span class="o">=</span><span class="nc">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
    <span class="n">prom</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">inertia_</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">prom</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[&lt;matplotlib.lines.Line2D at 0x27d41e95730&gt;]
</code></pre></div></div> <div> <figure> <picture> <img src="/assets/img/projects/topic/output_14_1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>The Kmeans plot algorithm from 1 cluster to 10 clusters, looks pretty much narrow and the scope to form further subgroups seems to be also very narrow (Advanced algorithms might give better results or maybe other classes will show some cluster possibility). However, there seems to be a slight bend at k=2 and k=4 (baby elbow :))</p> <div> <figure> <picture> <img src="/assets/img/projects/topic/ss1.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Forming just 2 clusters from 100+ documents seems a little monotonous, hence 4 clusters are created further to make the project interesting.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">true_k</span><span class="o">=</span><span class="mi">4</span>
<span class="n">true_model</span><span class="o">=</span><span class="nc">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">true_k</span><span class="p">)</span>
<span class="n">true_model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>KMeans(n_clusters=4)
</code></pre></div></div> <p>Parameter tuning for the model is not performed here, and the results might be better with some tweaks inside the Kmeans parameters</p> <blockquote> <p><strong>Forming clusters</strong></p> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">centroids</span> <span class="o">=</span> <span class="n">true_model</span><span class="p">.</span><span class="n">cluster_centers_</span><span class="p">.</span><span class="nf">argsort</span><span class="p">()[:,::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">terms</span><span class="o">=</span><span class="n">vr</span><span class="p">.</span><span class="nf">get_feature_names</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">true_k</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"cluster"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"-------"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">centroids</span><span class="p">[</span><span class="n">i</span><span class="p">,:</span><span class="mi">10</span><span class="p">]:</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cluster0
-------
indoor
european
holmes
world
record
second
olympic
best
championship
birmingham


cluster1
-------
race
cross
marathon
country
cross country
radcliffe
london
paula
world
chepkemei


cluster2
-------
kenteris
test
thanou
iaaf
greek
charge
drug test
tribunal
drug
athens


cluster3
-------
conte
balco
drug
collins
jones
doping
steroid
performance enhancing
enhancing
enhancing drug
</code></pre></div></div> <p>The resulted clusters look closely related yet, a prominant pattern can be seen among all of them.</p> <blockquote> <p><strong>Final Result</strong></p> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clusters</span><span class="o">=</span><span class="n">true_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'clusters'</span><span class="p">]</span><span class="o">=</span><span class="n">clusters</span>
<span class="n">df</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>title</th> <th>news</th> <th>clusters</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>Claxton hunting first major medal</td> <td>British hurdler Sarah Claxton is confident she...</td> <td>0</td> </tr> <tr> <th>1</th> <td>O'Sullivan could run in Worlds</td> <td>Sonia O'Sullivan has indicated that she would ...</td> <td>1</td> </tr> <tr> <th>2</th> <td>Greene sets sights on world title</td> <td>Maurice Greene aims to wipe out the pain of lo...</td> <td>0</td> </tr> <tr> <th>3</th> <td>IAAF launches fight against drugs</td> <td>The IAAF - athletics' world governing body - h...</td> <td>2</td> </tr> <tr> <th>4</th> <td>Dibaba breaks 5,000m world record</td> <td>Ethiopia's Tirunesh Dibaba set a new world rec...</td> <td>0</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>96</th> <td>Pittman drops coach for UK base</td> <td>Australia's world 400m hurdle champion Jana Pi...</td> <td>0</td> </tr> <tr> <th>97</th> <td>Lewis-Francis shakes off injury</td> <td>Sprinter Mark Lewis-Francis is determined to g...</td> <td>0</td> </tr> <tr> <th>98</th> <td>Holmes facing fine over trials</td> <td>Double Olympic champion Kelly Holmes faces a f...</td> <td>0</td> </tr> <tr> <th>99</th> <td>Freeman considers return to track</td> <td>Former Olympic champion Cathy Freeman said she...</td> <td>0</td> </tr> <tr> <th>100</th> <td>Event devised to nurture athletes</td> <td>UK Athletics has launched a new outdoor series...</td> <td>0</td> </tr> </tbody> </table> <p>101 rows × 3 columns</p> </div> <blockquote> <p><strong>Visualizing clusters</strong></p> </blockquote> <p>A method called ‘t-SNE’ that visualizes high dimensional data developed by Laurens van der Maaten, an AI researcher at facebook. An attempt to adapt that technique was failed, and instead a cluster plot using PCA was made. The idea was taken from a stackoverflow article.</p> <p>Link to the scientific literature: https://jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf <br> Link to the stackoverflow article: https://stackoverflow.com/questions/27494202/how-do-i-visualize-data-points-of-tf-idf-vectors-for-kmeans-clustering</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="n">kmeans_indices</span> <span class="o">=</span> <span class="n">true_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
<span class="n">pca</span> <span class="o">=</span> <span class="nc">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">scatter_plot_points</span> <span class="o">=</span> <span class="n">pca</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">vec</span><span class="p">.</span><span class="nf">toarray</span><span class="p">())</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s">"r"</span><span class="p">,</span><span class="s">"g"</span><span class="p">,</span><span class="s">"b"</span><span class="p">,</span><span class="s">"m"</span><span class="p">,</span><span class="s">"c"</span><span class="p">]</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">scatter_plot_points</span><span class="p">]</span>
<span class="n">y_axis</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">scatter_plot_points</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">kmeans_indices</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'title'</span><span class="p">]):</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">annotate</span><span class="p">(</span><span class="n">txt</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="p">(</span><span class="n">x_axis</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_axis</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    

</code></pre></div></div> <div> <figure> <picture> <img src="/assets/img/projects/topic/output_27_0.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <blockquote> <p><strong>Parting Thoughts</strong></p> </blockquote> <p>The Athletics class had several interesting areas, but overall the subtopics with which a majority of the documents coincided involded Indoor sports, Outdoor sports and Performance enhancing drugs. The subtopics ofcourse had major events like olympics, individual records, geographic location of the event, individuals involved etc. The resulting clusters that were formed in this particular excercise were: <br> <strong>Cluster0</strong>: Events and records from top competetions which are mainly indoor <br> <strong>Cluster1</strong>: Outdoor and track events such as marathons and races <br> <strong>Cluster2</strong>: Drug tests and people involved in drugs especially with the governing body IAAF <br> <strong>Cluster3</strong>: Individuals relating to steroids and PEDs but not much overlap with IAAF. ( Maybe just accusations and no tests )</p> <p>The same model was used to test documents in other classes as well. The results were similar as the classes are closely related and generating interesting topics with just a centroid based clustering algorithm(K-means) is not ideal. The ‘cricket’ class showed groups of countries which participated in certain competetions and the individuals who were the highlight between those fixtures, and the suit was followed by other team sports as well (Rugby and football). However, Tennis did not show any cluster signs, and plot was scattered realtively even.</p> <p>This how the <strong>tennis</strong> plot looked like: &lt;div&gt;</p> <figure> <picture> <img src="/assets/img/projects/topic/ss2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>&lt;/div&gt; Though, clusters were created, they did not have any semantic value.</p> <p>To conclude, this is one of the basic approaches to perform intra-class clustering. A higher semantic capture can be done with the use of advanced algorithms especially based on artificial neural networks.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Mohan Ramesh. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>